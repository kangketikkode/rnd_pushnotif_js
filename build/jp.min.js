console.log(">> JP Notif start working");const check=()=>{if(!("serviceWorker"in navigator))throw console.log(">> ERR:: no service worker support"),new Error("No Service Worker support");if(!("PushManager"in window))throw console.log(">> ERR:: No Push API support"),new Error("No Push API support")},registerServiceWorker=async()=>{return await navigator.serviceWorker.register("jp_notif_service.js")},requestNotificationPermission=async()=>{if("granted"!==await window.Notification.requestPermission())throw new Error("Notification pemission not granted")},mainJP=async()=>{check();await registerServiceWorker(),await requestNotificationPermission()},urlB64ToUint8Array=(document.addEventListener("DOMContentLoaded",function(){console.log("MAINJP"),mainJP()}),console.log(">> JP Notif Service start working"),e=>{e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/");const o=atob(e),t=new Uint8Array(o.length);for(let e=0;e<o.length;e++)t[e]=o.charCodeAt(e);return t}),saveSubscription=async e=>{const o=await fetch("http://139.99.73.252:4000/save-subscription",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return o.json()},showLocalNotification=(self.addEventListener("activate",async()=>{try{var e={applicationServerKey:urlB64ToUint8Array("BOdxIqq2MuZTW0lPWOz5SHcgNBJFC5aZP7jFeBcXl3sksX52a3MTDXdy-Du7yZ3vvy7OVxfAO_Wud0MQXmf6F4s"),userVisibleOnly:!0},o=await self.registration.pushManager.subscribe(e),t=(console.log(">> Service worker activated"),await saveSubscription(o));console.log(t)}catch(e){console.log("ERROR",e)}}),self.addEventListener("push",function(e){e.data?(console.log(">> Push event:: ",e.data.text()),showLocalNotification("JP789",e.data.text(),self.registration)):console.log(">> Push event but no data")}),(e,o,t)=>{t.showNotification(e,{body:o})});