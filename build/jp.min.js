console.log(">> JP Notif 0.2 start working");const check=()=>{if(!("serviceWorker"in navigator))throw console.log(">> ERR:: no service worker support"),new Error("No Service Worker support");if(!("PushManager"in window))throw console.log(">> ERR:: No Push API support"),new Error("No Push API support")},registerServiceWorker=async()=>{return await navigator.serviceWorker.register("jp_notif_service.js")},requestNotificationPermission=async()=>{if("granted"!==await window.Notification.requestPermission())throw new Error("Notification pemission not granted")},mainJP=async()=>{check();await registerServiceWorker(),await requestNotificationPermission()},urlB64ToUint8Array=("loading"!==document.readyState?(console.log(">> Document ready, start MainJP"),mainJP()):document.addEventListener("DOMContentLoaded",function(){console.log("MAINJP"),mainJP()}),console.log(">> JP Notif Service start working"),base64String=>{base64String=(base64String+"=".repeat((4-base64String.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/");const rawData=atob(base64String),outputArray=new Uint8Array(rawData.length);for(let i=0;i<rawData.length;i++)outputArray[i]=rawData.charCodeAt(i);return outputArray}),saveSubscription=async subscription=>{const response=await fetch("http://139.99.73.252:4000/save-subscription",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(subscription)});return response.json()},showLocalNotification=(self.addEventListener("activate",async()=>{try{var options={applicationServerKey:urlB64ToUint8Array("BOdxIqq2MuZTW0lPWOz5SHcgNBJFC5aZP7jFeBcXl3sksX52a3MTDXdy-Du7yZ3vvy7OVxfAO_Wud0MQXmf6F4s"),userVisibleOnly:!0},subscription=await self.registration.pushManager.subscribe(options),response=(console.log(">> Service worker activated"),await saveSubscription(subscription));console.log(response)}catch(err){console.log("ERROR",err)}}),self.addEventListener("push",function(event){event.data?(console.log(">> Push event:: ",event.data.text()),showLocalNotification("JP789",event.data.text(),self.registration)):console.log(">> Push event but no data")}),(title,body,swRegistration)=>{swRegistration.showNotification(title,{body:body})});